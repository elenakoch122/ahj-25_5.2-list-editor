{"version":3,"file":"main.js","mappings":"mBACA,IAAIA,ECDoB,G,oECGT,MAAMC,EACnBC,YAAYC,EAAMC,GAChBC,KAAKF,KAAOA,EACZE,KAAKD,MAAQA,EACbC,KAAKC,GAAKC,YAAYC,KACxB,CAEWC,oBACT,MAAQ,8NAKwCC,6JAGEC,mEAIpD,CAEAC,SACE,MAAMC,EAAUC,SAASC,cAAc,OACvCF,EAAQG,UAAUC,IAAI,WACtBJ,EAAQK,aAAa,UAAWb,KAAKC,IAErC,MAAMa,EAAclB,EAAQQ,OAS5B,OARAI,EAAQO,mBAAmB,YAAaD,GAEpBN,EAAQQ,cAAc,iBAC9BC,YAAcjB,KAAKF,KAEVU,EAAQQ,cAAc,kBAC9BC,YAAcjB,KAAKD,MAEzBS,CACT,CAEAU,YACElB,KAAKmB,QAAUnB,KAAKO,SACpBE,SAASO,cAAc,aAAaI,YAAYpB,KAAKmB,QACvD,CAEAE,OACErB,KAAKmB,QAAQH,cAAc,iBAAiBC,YAAcjB,KAAKF,KAC/DE,KAAKmB,QAAQH,cAAc,kBAAkBC,YAAcjB,KAAKD,KAClE,EClDa,MAAMuB,EACnBzB,YAAY0B,EAAMC,GAChBxB,KAAKyB,UAAYF,EACjBvB,KAAKwB,QAAUA,EACfxB,KAAK0B,UAAY1B,KAAKO,QACxB,CAEAA,SACE,MAAMoB,EAAUlB,SAASC,cAAc,OAGvC,OAFAiB,EAAQhB,UAAUC,IAAI,WACtBe,EAAQV,YAAcjB,KAAKwB,QACpBG,CACT,CAEAC,OACE5B,KAAKyB,UAAUI,cAAcT,YAAYpB,KAAK0B,WAE9C,MAAQI,UAAWC,EAAKC,WAAYC,EAAMC,aAAcC,GAAWnC,KAAKyB,UACxEzB,KAAK0B,UAAUU,MAAMH,KAAQ,GAAEA,MAC/BjC,KAAK0B,UAAUU,MAAML,IAAO,GAAEA,EAAMI,EAAS,KAC/C,CAEAE,SACErC,KAAK0B,UAAUW,QACjB,ECpBa,MAAMC,EACnBzC,cACEG,KAAKuC,SAAW,GAEhBvC,KAAKwC,MAAQxC,KAAKwC,MAAMC,KAAKzC,MAC7BA,KAAK0C,QAAU1C,KAAK0C,QAAQD,KAAKzC,KACnC,CAEA2C,cAAgB,CACd7C,KAAM,CACJ8C,aAAc,+BAEhB7C,MAAO,CACL6C,aAAc,2BACdC,aAAc,yCACdC,eAAgB,kCAIpBH,gBAAgBpB,GACd,MAAMwB,EAAWC,OAAOC,KAAKC,cAAcC,WAAWC,MAAMC,IAC1D,GAAY,UAARA,EACJ,OAAI9B,EAAK+B,SAASD,GACTA,OADT,CAEA,IAEF,GAAKN,EAEL,OAAOT,EAAUiB,OAAOhC,EAAKzB,MAAMiD,EACrC,CAEAL,QAAQc,GACNxD,KAAKwC,MAAMgB,EAAEC,OACf,CAEAjB,MAAMjB,GACJvB,KAAKuC,SAASmB,SAAQ,CAACC,EAAGC,EAAKC,KACzBF,EAAElC,YAAcF,IAClBoC,EAAEtB,SACFwB,EAAIC,OAAOF,EAAK,GAClB,IAGF,MAAMG,EAAYzB,EAAU0B,SAASzC,GAErC,GAAIwC,EAAW,CACb,MAAMpC,EAAU,IAAIL,EAAQC,EAAMwC,GAClCpC,EAAQC,OACR5B,KAAKuC,SAAS0B,KAAKtC,EACrB,CACF,ECnDa,MAAMuC,EACnBrE,YAAYsE,GACVnE,KAAKmE,MAAQA,EACbnE,KAAKoE,SAAW3D,SAASO,cAAc,WACvChB,KAAKmB,QAAUnB,KAAKO,SACpBP,KAAKqE,UAAYrE,KAAKmB,QAAQH,cAAc,eAC5ChB,KAAKsE,WAAatE,KAAKmB,QAAQH,cAAc,gBAC7ChB,KAAKuE,UAAY,IAAIjC,EAErBtC,KAAKwE,aAAexE,KAAKwE,aAAa/B,KAAKzC,MAC3CA,KAAKyE,eAAiBzE,KAAKyE,eAAehC,KAAKzC,KACjD,CAEWI,oBACT,MAAQ,6nBAgBV,CAGAG,SACE,MAAMmE,EAAQjE,SAASC,cAAc,QACrCgE,EAAM/D,UAAUC,IAAI,SACpB8D,EAAM7D,aAAa,aAAc,IAEjC,MAAM8D,EAAYT,EAAM9D,OAGxB,OAFAsE,EAAM3D,mBAAmB,YAAa4D,GAE/BD,CACT,CAEA9C,OAAgB,IAAX3B,EAAK,UAAH,6CAAG,KACRD,KAAKoE,SAAShD,YAAYpB,KAAKmB,SAE/B,MAAMyD,EAAe5E,KAAKmB,QAAQH,cAAc,oBAChDhB,KAAK6E,SAAW7E,KAAKmB,QAAQ2D,iBAAiB,UAE1C7E,IACFD,KAAK+E,YAAc/E,KAAKmE,MAAMa,SAAS5B,MAAM6B,GAAMA,EAAEhF,KAAOA,IAE5DD,KAAKqE,UAAUa,MAAQlF,KAAK+E,YAAYjF,KACxCE,KAAKsE,WAAWY,MAAQlF,KAAK+E,YAAYhF,OAG3C6E,EAAaO,iBAAiB,QAASnF,KAAKyE,gBAC5CzE,KAAK6E,SAASnB,SAAS0B,GAAMA,EAAED,iBAAiB,QAASnF,KAAKuE,UAAU7B,UAC1E,CAEA2C,OACErF,KAAKqE,UAAUa,MAAQ,GACvBlF,KAAKsE,WAAWY,MAAQ,GACxBlF,KAAK+E,YAAc,KACnB/E,KAAKmB,QAAQkB,QACf,CAEAmC,aAAahB,GACX,GAAIA,EAAEC,OAAO6B,gBAAiB,CAC5B,GAAItF,KAAK+E,YACP/E,KAAK+E,YAAYjF,KAAOE,KAAKqE,UAAUa,MACvClF,KAAK+E,YAAYhF,MAAQwF,OAAOvF,KAAKsE,WAAWY,OAChDlF,KAAK+E,YAAY1D,WACZ,CACL,MAAMb,EAAU,IAAIZ,EAAQI,KAAKqE,UAAUa,MAAOK,OAAOvF,KAAKsE,WAAWY,QACzE1E,EAAQU,YACRlB,KAAKmE,MAAMa,SAASf,KAAKzD,EAC3B,CAEAR,KAAKqF,MACP,MACErF,KAAK6E,SAASnB,SAAS8B,GAAUxF,KAAKuE,UAAU/B,MAAMgD,IAE1D,CAEAf,iBACEzE,KAAKqF,MACP,EC3Fa,MAAMI,EACnB5F,cACEG,KAAKgF,SAAW,EAClB,ECAF,MAAMU,EAAe,ICHN,MACb7F,YAAY8F,GACV3F,KAAK2F,QAAUA,CACjB,CAEAC,KAAKzB,GACHnE,KAAK2F,QAAQE,QAAQ,WAAYC,KAAKC,UAAU5B,GAClD,CAEA6B,OACE,IACE,OAAOF,KAAKG,MAAMjG,KAAK2F,QAAQO,QAAQ,YAGzC,CAFE,MAAO1C,GACP,MAAM,IAAI2C,MAAM,gBAClB,CACF,GDZoCC,cAChCC,EAAS,IEAA,MACbxG,YAAY6F,GACV1F,KAAKqG,OAAS5F,SAASO,cAAc,WACrChB,KAAK0F,aAAeA,EACpB1F,KAAKmE,MAAQ,IAAIsB,EACjBzF,KAAK0E,MAAQ,IAAIR,EAAMlE,KAAKmE,OAE5BnE,KAAKsG,UAAYtG,KAAKsG,UAAU7D,KAAKzC,MACrCA,KAAKuG,YAAcvG,KAAKuG,YAAY9D,KAAKzC,MACzCA,KAAKwG,YAAcxG,KAAKwG,YAAY/D,KAAKzC,MACzCA,KAAKyG,cAAgBzG,KAAKyG,cAAchE,KAAKzC,KAC/C,CAEA0G,OACE1G,KAAK2G,UAAYlG,SAASO,cAAc,YAExChB,KAAK2G,UAAUxB,iBAAiB,QAASnF,KAAKsG,WAC9CtG,KAAKqG,OAAOlB,iBAAiB,SAAUnF,KAAKuG,aAC5CvG,KAAKqG,OAAOlB,iBAAiB,QAASnF,KAAKwG,aAC3CxG,KAAKqG,OAAOlB,iBAAiB,QAASnF,KAAKyG,eAE3CG,OAAOzB,iBAAiB,gBAAgB,KACtCnF,KAAK0F,aAAaE,KAAK5F,KAAKmE,MAAM,IAGpC1D,SAAS0E,iBAAiB,oBAAoB,KAC5C,MAAM,SAAEH,GAAahF,KAAK0F,aAAaM,OAEnChB,EAAS6B,OAAS,GACpB7G,KAAK8G,aAAa9B,EACpB,GAEJ,CAEAsB,YACEtG,KAAK0E,MAAM9C,MACb,CAGAkF,aAAa9B,GACXA,EAAStB,SAASuB,IAChB,MAAMzE,EAAU,IAAIZ,EAAQqF,EAAEnF,KAAMmF,EAAElF,OACtCC,KAAKmE,MAAMa,SAASf,KAAKzD,GACzBA,EAAQU,WAAW,GAEvB,CAEAqF,YAAY/C,GACVA,EAAEuD,iBACF/G,KAAK0E,MAAMF,aAAahB,EAC1B,CAEAgD,YAAYhD,GACV,IAAKA,EAAEC,OAAO9C,UAAUqG,SAAS,QAAS,OAC1C,MAAMxG,EAAUgD,EAAEC,OAAOwD,QAAQ,YAC3BhH,EAAKsF,OAAO/E,EAAQ0G,aAAa,YACvClH,KAAK0E,MAAM9C,KAAK3B,EAClB,CAEAwG,cAAcjD,GACZ,IAAKA,EAAEC,OAAO9C,UAAUqG,SAAS,UAAW,OAC5C,MAAMxG,EAAUgD,EAAEC,OAAOwD,QAAQ,YAC3BhH,EAAKsF,OAAO/E,EAAQ0G,aAAa,YACvClH,KAAKmE,MAAMa,SAAWhF,KAAKmE,MAAMa,SAASmC,QAAQlC,GAAMA,EAAEhF,KAAOA,IACjEO,EAAQ6B,QACV,GFjEwBqD,GAE1BW,EAAOK,M","sources":["webpack://ahj-25_5.2-list-editor/webpack/bootstrap","webpack://ahj-25_5.2-list-editor/webpack/runtime/publicPath","webpack://ahj-25_5.2-list-editor/./src/js/Product.js","webpack://ahj-25_5.2-list-editor/./src/js/Tooltip.js","webpack://ahj-25_5.2-list-editor/./src/js/Validator.js","webpack://ahj-25_5.2-list-editor/./src/js/Popup.js","webpack://ahj-25_5.2-list-editor/./src/js/State.js","webpack://ahj-25_5.2-list-editor/./src/js/app.js","webpack://ahj-25_5.2-list-editor/./src/js/StateService.js","webpack://ahj-25_5.2-list-editor/./src/js/Widget.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","__webpack_require__.p = \"\";","import editIcon from '../pic/edit-icon.png';\nimport deleteIcon from '../pic/delete-icon.png';\n\nexport default class Product {\n  constructor(name, price) {\n    this.name = name;\n    this.price = price;\n    this.id = performance.now();\n  }\n\n  static get markup() {\n    return `\n    <div class=\"cell product-name\"></div>\n    <div class=\"cell product-price\"></div>\n    <div class=\"cell product-action\">\n      <div class=\"product-action-wrap\">\n        <img class=\"product-action-img edit\" src=\"${editIcon}\" alt=\"Редактировать\" title=\"Редактировать\">\n      </div>\n      <div class=\"product-action-wrap\">\n        <img class=\"product-action-img delete\" src=\"${deleteIcon}\" alt=\"Закрыть\" title=\"Закрыть\">\n      </div>\n    </div>\n    `;\n  }\n\n  create() {\n    const product = document.createElement('div');\n    product.classList.add('product');\n    product.setAttribute('data-id', this.id);\n\n    const productBody = Product.markup;\n    product.insertAdjacentHTML('beforeend', productBody);\n\n    const productName = product.querySelector('.product-name');\n    productName.textContent = this.name;\n\n    const productPrice = product.querySelector('.product-price');\n    productPrice.textContent = this.price;\n\n    return product;\n  }\n\n  addToList() {\n    this.element = this.create();\n    document.querySelector('.products').appendChild(this.element);\n  }\n\n  edit() {\n    this.element.querySelector('.product-name').textContent = this.name;\n    this.element.querySelector('.product-price').textContent = this.price;\n  }\n}\n","export default class Tooltip {\n  constructor(elem, message) {\n    this.relatedEl = elem;\n    this.message = message;\n    this.tooltipEl = this.create();\n  }\n\n  create() {\n    const tooltip = document.createElement('div');\n    tooltip.classList.add('tooltip');\n    tooltip.textContent = this.message;\n    return tooltip;\n  }\n\n  show() {\n    this.relatedEl.parentElement.appendChild(this.tooltipEl);\n\n    const { offsetTop: top, offsetLeft: left, offsetHeight: height } = this.relatedEl;\n    this.tooltipEl.style.left = `${left}px`;\n    this.tooltipEl.style.top = `${top + height + 5}px`;\n  }\n\n  remove() {\n    this.tooltipEl.remove();\n  }\n}\n","/* eslint-disable array-callback-return */\n/* eslint-disable consistent-return */\nimport Tooltip from './Tooltip';\n\nexport default class Validator {\n  constructor() {\n    this.tooltips = [];\n\n    this.check = this.check.bind(this);\n    this.onCheck = this.onCheck.bind(this);\n  }\n\n  static errors = {\n    name: {\n      valueMissing: 'Укажите наименование товара',\n    },\n    price: {\n      valueMissing: 'Укажите стоимость товара',\n      typeMismatch: 'Значение должно содержать только цифры',\n      rangeUnderflow: 'Допустимое значение 1 и более',\n    },\n  };\n\n  static getError(elem) {\n    const errorKey = Object.keys(ValidityState.prototype).find((key) => {\n      if (key === 'valid') return;\n      if (elem.validity[key]) {\n        return key;\n      }\n    });\n    if (!errorKey) return;\n\n    return Validator.errors[elem.name][errorKey];\n  }\n\n  onCheck(e) {\n    this.check(e.target);\n  }\n\n  check(elem) {\n    this.tooltips.forEach((t, idx, arr) => {\n      if (t.relatedEl === elem) {\n        t.remove();\n        arr.splice(idx, 1);\n      }\n    });\n\n    const errorText = Validator.getError(elem);\n\n    if (errorText) {\n      const tooltip = new Tooltip(elem, errorText);\n      tooltip.show();\n      this.tooltips.push(tooltip);\n    }\n  }\n}\n","import Product from './Product';\nimport Validator from './Validator';\n\nexport default class Popup {\n  constructor(state) {\n    this.state = state;\n    this.parentEl = document.querySelector('.widget');\n    this.element = this.create();\n    this.inputName = this.element.querySelector('#input-name');\n    this.inputPrice = this.element.querySelector('#input-price');\n    this.validator = new Validator();\n\n    this.onButtonSave = this.onButtonSave.bind(this);\n    this.onButtonCancel = this.onButtonCancel.bind(this);\n  }\n\n  static get markup() {\n    return `\n    <div class=\"popup-block\">\n      <label for=\"input-name\">Наименование</label>\n      <input id=\"input-name\" class=\"input\" name=\"name\" type=\"text\" placeholder=\"Например, Samsung S3\" required>\n    </div>\n\n    <div class=\"popup-block\">\n      <label for=\"input-price\">Стоимость</label>\n      <input id=\"input-price\" class=\"input\" name=\"price\" type=\"number\" placeholder=\"Например, 15000\" required min=\"1\">\n    </div>\n\n    <div class=\"popup-footer\">\n      <button class=\"btn-popup btn-popup-save\" type=\"submit\">Сохранить</button>\n      <button class=\"btn-popup btn-popup-close\" type=\"button\">Отмена</button>\n    </div>\n    `;\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  create() {\n    const popup = document.createElement('form');\n    popup.classList.add('popup');\n    popup.setAttribute('novalidate', '');\n\n    const popupBody = Popup.markup;\n    popup.insertAdjacentHTML('beforeend', popupBody);\n\n    return popup;\n  }\n\n  show(id = null) {\n    this.parentEl.appendChild(this.element);\n\n    const buttonCancel = this.element.querySelector('.btn-popup-close');\n    this.inputArr = this.element.querySelectorAll('.input');\n\n    if (id) {\n      this.editProduct = this.state.products.find((p) => p.id === id);\n\n      this.inputName.value = this.editProduct.name;\n      this.inputPrice.value = this.editProduct.price;\n    }\n\n    buttonCancel.addEventListener('click', this.onButtonCancel);\n    this.inputArr.forEach((i) => i.addEventListener('input', this.validator.onCheck));\n  }\n\n  hide() {\n    this.inputName.value = '';\n    this.inputPrice.value = '';\n    this.editProduct = null;\n    this.element.remove();\n  }\n\n  onButtonSave(e) {\n    if (e.target.checkValidity()) {\n      if (this.editProduct) {\n        this.editProduct.name = this.inputName.value;\n        this.editProduct.price = Number(this.inputPrice.value);\n        this.editProduct.edit();\n      } else {\n        const product = new Product(this.inputName.value, Number(this.inputPrice.value));\n        product.addToList();\n        this.state.products.push(product);\n      }\n\n      this.hide();\n    } else {\n      this.inputArr.forEach((input) => this.validator.check(input));\n    }\n  }\n\n  onButtonCancel() {\n    this.hide();\n  }\n}\n","export default class State {\n  constructor() {\n    this.products = [];\n  }\n}\n","import Widget from './Widget';\nimport StateService from './StateService';\n\nconst stateService = new StateService(localStorage);\nconst widget = new Widget(stateService);\n\nwidget.init();\n","export default class StateService {\n  constructor(storage) {\n    this.storage = storage;\n  }\n\n  save(state) {\n    this.storage.setItem('products', JSON.stringify(state));\n  }\n\n  load() {\n    try {\n      return JSON.parse(this.storage.getItem('products'));\n    } catch (e) {\n      throw new Error('Invalid state');\n    }\n  }\n}\n","import Popup from './Popup';\nimport Product from './Product';\nimport State from './State';\n\nexport default class Widget {\n  constructor(stateService) {\n    this.widget = document.querySelector('.widget');\n    this.stateService = stateService;\n    this.state = new State();\n    this.popup = new Popup(this.state);\n\n    this.showPopup = this.showPopup.bind(this);\n    this.onSaveClick = this.onSaveClick.bind(this);\n    this.onEditClick = this.onEditClick.bind(this);\n    this.onDeleteClick = this.onDeleteClick.bind(this);\n  }\n\n  init() {\n    this.addButton = document.querySelector('.btn-add');\n\n    this.addButton.addEventListener('click', this.showPopup);\n    this.widget.addEventListener('submit', this.onSaveClick);\n    this.widget.addEventListener('click', this.onEditClick);\n    this.widget.addEventListener('click', this.onDeleteClick);\n\n    window.addEventListener('beforeunload', () => {\n      this.stateService.save(this.state);\n    });\n\n    document.addEventListener('DOMContentLoaded', () => {\n      const { products } = this.stateService.load();\n\n      if (products.length > 0) {\n        this.drawProducts(products);\n      }\n    });\n  }\n\n  showPopup() {\n    this.popup.show();\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  drawProducts(products) {\n    products.forEach((p) => {\n      const product = new Product(p.name, p.price);\n      this.state.products.push(product);\n      product.addToList();\n    });\n  }\n\n  onSaveClick(e) {\n    e.preventDefault();\n    this.popup.onButtonSave(e);\n  }\n\n  onEditClick(e) {\n    if (!e.target.classList.contains('edit')) return;\n    const product = e.target.closest('.product');\n    const id = Number(product.getAttribute('data-id'));\n    this.popup.show(id);\n  }\n\n  onDeleteClick(e) {\n    if (!e.target.classList.contains('delete')) return;\n    const product = e.target.closest('.product');\n    const id = Number(product.getAttribute('data-id'));\n    this.state.products = this.state.products.filter((p) => p.id !== id);\n    product.remove();\n  }\n}\n"],"names":["__webpack_require__","Product","constructor","name","price","this","id","performance","now","markup","editIcon","deleteIcon","create","product","document","createElement","classList","add","setAttribute","productBody","insertAdjacentHTML","querySelector","textContent","addToList","element","appendChild","edit","Tooltip","elem","message","relatedEl","tooltipEl","tooltip","show","parentElement","offsetTop","top","offsetLeft","left","offsetHeight","height","style","remove","Validator","tooltips","check","bind","onCheck","static","valueMissing","typeMismatch","rangeUnderflow","errorKey","Object","keys","ValidityState","prototype","find","key","validity","errors","e","target","forEach","t","idx","arr","splice","errorText","getError","push","Popup","state","parentEl","inputName","inputPrice","validator","onButtonSave","onButtonCancel","popup","popupBody","buttonCancel","inputArr","querySelectorAll","editProduct","products","p","value","addEventListener","i","hide","checkValidity","Number","input","State","stateService","storage","save","setItem","JSON","stringify","load","parse","getItem","Error","localStorage","widget","showPopup","onSaveClick","onEditClick","onDeleteClick","init","addButton","window","length","drawProducts","preventDefault","contains","closest","getAttribute","filter"],"sourceRoot":""}